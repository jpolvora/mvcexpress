# mvcexpress
Mvc Structure for Express and Node.js

Convention over configuration.

# Install
```js
npm install --save jpolvora/mvcexpress
```

# Configure
`app.js`
```js
const mvcexpress = require('mvcexpress')
app.use('/', mvcexpress({
    /* inject services here */)
    //services will be injected in controllers contructor
})
```

# Usage
Create a folder named `controllers` at root path of your express application. Then place your controllers inside this folder. Remember to use always lowercase names for the controllers.

The default route is: `/{controllerName}/{actionName}`

The default controllerName is `home`.

The default actionName is `index`.

This means that the framework will search for a module at `/controllers/home.js`.

Here is an example of a controller:

`/controllers/home.js`

```js
//view is injected by default. It's a helper method that render templates using res.render(viewName, model)
module.exports = function ( { view } ) {
    return {
        /* path: /home/index or /  */
        index: (req) => {
           return view("index", { title: "express..." })
        },
        /* path: /home/about  */
        about: (req) => {
            /* returning a string that will be rendered by res.send */
            return "I'm about page."
        },
        /* path: /home/{any}  */
        catchAll: (req) => {
        /* returning a function that accepts res parameter (the response object from express) */
            return function (res) {
                res.send("When an action is not found, the catchAll enters in action.");
            }
        }
    }
}
```

# Demo application
Clone this repo, go to folder /demo and run `npm install`.

This demo is an application generated by express generator with jade template engine.

### Adding more controllers

Just create a new module inside `controllers` folder, for example: 
`/controllers/users.js`
```js
//this controller doesn't return a function, so nothing will be injected.
//In order to use services injection, use the function(services) {} format
module.exports = {
    //users/index
    index: function(req) {
        return "Welcome to /users/index route."
    },
    //users/create
    create: function(req) {
        if (req.method === "POST") {
            let form = req.body;
            fakeDataService.saveUser(form).then((result) => {
                return (res) => {
                    res.status(201); //created
                }
            });
        } else {
            return (res) => {
                res.render('myview', {})
            }
        }
    }
}
```
